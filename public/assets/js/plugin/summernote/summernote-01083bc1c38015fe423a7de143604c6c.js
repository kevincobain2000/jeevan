!function(t){"use strict";var e=navigator.appVersion.indexOf("Mac")>-1,n=navigator.userAgent.indexOf("MSIE")>-1,a=function(){var t=function(t){return function(e){return t===e}},e=function(t,e){return t===e},n=function(){return!1},a=function(t){return function(){return!t.apply(t,arguments)}},o=function(t){return t};return{eq:t,eq2:e,fail:n,not:a,self:o}}(),o=function(){var t=function(t){return t[0]},e=function(t){return t[t.length-1]},n=function(t){return t.slice(0,t.length-1)},o=function(t){return t.slice(1)},i=function(t,e){return e=e||a.self,t.reduce(function(t,n){return t+e(n)},0)},r=function(t){for(var e=[],n=-1,a=t.length;++n<a;)e[n]=t[n];return e},l=function(n,a){if(0===n.length)return[];var i=o(n);return i.reduce(function(t,n){var o=e(t);return a(e(o),n)?o[o.length]=n:t[t.length]=[n],t},[[t(n)]])},d=function(t){for(var e=[],n=0,a=t.length;a>n;n++)t[n]&&e.push(t[n]);return e};return{head:t,last:e,initial:n,tail:o,sum:i,from:r,compact:d,clusterBy:l}}(),i=function(){var e=function(t){return function(e){return e&&e.nodeName===t}},n=function(t){return t&&/^P|^LI|^H[1-7]/.test(t.nodeName)},r=function(t){return t&&/^UL|^OL/.test(t.nodeName)},l=function(e){return e&&t(e).hasClass("note-editable")},d=function(e){return e&&t(e).hasClass("note-control-sizing")},s=function(t,e){for(;t;){if(e(t))return t;t=t.parentNode}return null},c=function(t,e){e=e||a.fail;var n=[];return s(t,function(t){return n.push(t),e(t)}),n},u=function(e,n){for(var a=c(e),o=n;o;o=o.parentNode)if(t.inArray(o,a)>-1)return o;return null},f=function(t,e){var n=[],a=!1,o=!1,i=function(r){if(r){if(r===t&&(a=!0),a&&!o&&n.push(r),r===e)return o=!0,void 0;for(var l=0,d=r.childNodes.length;d>l;l++)i(r.childNodes[l])}};return i(u(t,e)),n},h=function(t,e){e=e||a.fail;for(var n=[];t&&(n.push(t),!e(t));)t=t.previousSibling;return n},v=function(t,e){e=e||a.fail;for(var n=[];t&&(n.push(t),!e(t));)t=t.nextSibling;return n},b=function(t,e){var n=e.nextSibling,a=e.parentNode;return n?a.insertBefore(t,n):a.appendChild(t),t},g=function(e,n){return t.each(n,function(t,n){e.appendChild(n)}),e},p=e("#text"),m=function(t){return p(t)?t.nodeValue.length:t.childNodes.length},y=function(t){for(var e=0;t=t.previousSibling;)e+=1;return e},C=function(e,n){var i=o.initial(c(n,a.eq(e)));return t.map(i,y).reverse()},k=function(t,e){for(var n=t,a=0,o=e.length;o>a;a++)n=n.childNodes[e[a]];return n},x=function(t,e){if(0===e)return t;if(e>=m(t))return t.nextSibling;if(p(t))return t.splitText(e);var n=t.childNodes[e];return t=b(t.cloneNode(!1),t),g(t,v(n))},w=function(t,e,n){var o=c(e,a.eq(t));return 1===o.length?x(e,n):o.reduce(function(t,a){var o=a.cloneNode(!1);return b(o,a),t===e&&(t=x(t,n)),g(o,v(t)),o})},F=function(t,e){if(t&&t.parentNode){if(t.removeNode)return t.removeNode(e);var n=t.parentNode;if(!e){for(var a=[],o=0,i=t.childNodes.length;i>o;o++)a.push(t.childNodes[o]);for(var o=0,i=a.length;i>o;o++)n.insertBefore(a[o],t)}n.removeChild(t)}},A=function(e){return t("<div/>").html(e).text()},S=function(t){return i.isTextarea(t[0])?A(t.val()):t.html()};return{isText:p,isPara:n,isList:r,isEditable:l,isControlSizing:d,isAnchor:e("A"),isDiv:e("DIV"),isSpan:e("SPAN"),isB:e("B"),isU:e("U"),isS:e("S"),isI:e("I"),isImg:e("IMG"),isTextarea:e("TEXTAREA"),ancestor:s,listAncestor:c,listNext:v,listPrev:h,commonAncestor:u,listBetween:f,insertAfter:b,position:y,makeOffsetPath:C,fromOffsetPath:k,split:w,remove:F,html:S}}(),r=function(){var e=!!document.createRange,n=function(t,e){var n,a,r=t.parentElement(),l=document.body.createTextRange(),d=o.from(r.childNodes);for(n=0;n<d.length;n++)if(!i.isText(d[n])){if(l.moveToElementText(d[n]),l.compareEndPoints("StartToStart",t)>=0)break;a=d[n]}if(0!=n&&i.isText(d[n-1])){var s=document.body.createTextRange(),c=null;s.moveToElementText(a||r),s.collapse(!a),c=a?a.nextSibling:r.firstChild;var u=t.duplicate();u.setEndPoint("StartToStart",s);for(var f=u.text.replace(/[\r\n]/g,"").length;f>c.nodeValue.length&&c.nextSibling;)f-=c.nodeValue.length,c=c.nextSibling;{c.nodeValue}e&&c.nextSibling&&i.isText(c.nextSibling)&&f==c.nodeValue.length&&(f-=c.nodeValue.length,c=c.nextSibling),r=c,n=f}return{cont:r,offset:n}},r=function(t){var e=function(t,n){var r,l;if(i.isText(t)){var d=i.listPrev(t,a.not(i.isText)),s=o.last(d).previousSibling;r=s||t.parentNode,n+=o.sum(o.tail(d),i.length),l=!s}else{if(r=t.childNodes[n]||t,i.isText(r))return e(r,n);n=0,l=!1}return{cont:r,collapseToStart:l,offset:n}},n=document.body.createTextRange(),r=e(t.cont,t.offset);return n.moveToElementText(r.cont),n.collapse(r.collapseToStart),n.moveStart("character",r.offset),n},l=function(n,l,d,s){this.sc=n,this.so=l,this.ec=d,this.eo=s;var c=function(){if(e){var t=document.createRange();return t.setStart(n,l),t.setEnd(d,s),t}var a=r({cont:n,offset:l});return a.setEndPoint("EndToEnd",r({cont:d,offset:s})),a};this.select=function(){var t=c();if(e){var n=document.getSelection();n.rangeCount>0&&n.removeAllRanges(),n.addRange(t)}else t.select()},this.listPara=function(){var e=i.listBetween(n,d),r=o.compact(t.map(e,function(t){return i.ancestor(t,i.isPara)}));return t.map(o.clusterBy(r,a.eq2),o.head)};var u=function(t){return function(){var e=i.ancestor(n,t);return e&&e===i.ancestor(d,t)}};this.isOnEditable=u(i.isEditable),this.isOnList=u(i.isList),this.isOnAnchor=u(i.isAnchor),this.isCollapsed=function(){return n===d&&l===s},this.insertNode=function(t){var n=c();e?n.insertNode(t):n.pasteHTML(t.outerHTML)},this.toString=function(){var t=c();return e?t.toString():t.text},this.bookmark=function(t){return{s:{path:i.makeOffsetPath(t,n),offset:l},e:{path:i.makeOffsetPath(t,d),offset:s}}}};return{create:function(t,a,o,i){if(0===arguments.length)if(e){var r=document.getSelection().getRangeAt(0);t=r.startContainer,a=r.startOffset,o=r.endContainer,i=r.endOffset}else{var d=document.selection.createRange(),s=d.duplicate();s.collapse(!1);var c=d;c.collapse(!0);var u=n(c,!0),f=n(s,!1);t=u.cont,a=u.offset,o=f.cont,i=f.offset}else 2===arguments.length&&(o=t,i=a);return new l(t,a,o,i)},createFromBookmark:function(t,e){var n=i.fromOffsetPath(t,e.s.path),a=e.s.offset,o=i.fromOffsetPath(t,e.e.path),r=e.e.offset;return new l(n,a,o,r)}}}(),l=function(){this.stylePara=function(e,n){var a=e.listPara();t.each(a,function(e,a){t.each(n,function(t,e){a.style[t]=e})})},this.current=function(e,n){var a=t(i.isText(e.sc)?e.sc.parentNode:e.sc),o=a.css(["font-size","text-align","list-style-type","line-height"])||{};if(o["font-size"]=parseInt(o["font-size"]),o["font-bold"]=document.queryCommandState("bold")?"bold":"normal",o["font-italic"]=document.queryCommandState("italic")?"italic":"normal",o["font-underline"]=document.queryCommandState("underline")?"underline":"normal",e.isOnList()){var r=["circle","disc","disc-leading-zero","square"],l=t.inArray(o["list-style-type"],r)>-1;o["list-style"]=l?"unordered":"ordered"}else o["list-style"]="none";var d=i.ancestor(e.sc,i.isPara);if(d&&d.style["line-height"])o["line-height"]=d.style.lineHeight;else{var s=parseInt(o["line-height"])/parseInt(o["font-size"]);o["line-height"]=s.toFixed(1)}return o.image=i.isImg(n)&&n,o.anchor=e.isOnAnchor()&&i.ancestor(e.sc,i.isAnchor),o.aAncestor=i.listAncestor(e.sc,i.isEditable),o}},d=function(){var t=[],e=[],n=function(t){var e=t[0],n=r.create();return{contents:t.html(),bookmark:n.bookmark(e),scrollTop:t.scrollTop()}},a=function(t,e){t.html(e.contents).scrollTop(e.scrollTop),r.createFromBookmark(t[0],e.bookmark).select()};this.undo=function(o){var i=n(o);0!==t.length&&(a(o,t.pop()),e.push(i))},this.redo=function(o){var i=n(o);0!==e.length&&(a(o,e.pop()),t.push(i))},this.recordUndo=function(a){e=[],t.push(n(a))}},s=function(){var e=new l;this.currentStyle=function(t){var n=r.create();return n.isOnEditable()&&e.current(n,t)},this.tab=function(e){a(e);var n=r.create(),o=new Array(e.data("tabsize")+1).join("&nbsp;");n.insertNode(t('<span id="noteTab">'+o+"</span>")[0]);var l=t("#noteTab").removeAttr("id");n=r.create(l[0],1),n.select(),i.remove(l[0])},this.undo=function(t){t.data("NoteHistory").undo(t)},this.redo=function(t){t.data("NoteHistory").redo(t)};for(var a=this.recordUndo=function(t){t.data("NoteHistory").recordUndo(t)},o=["bold","italic","underline","strikethrough","justifyLeft","justifyCenter","justifyRight","justifyFull","insertOrderedList","insertUnorderedList","indent","outdent","formatBlock","removeFormat","backColor","foreColor","insertImage","insertHorizontalRule"],d=0,s=o.length;s>d;d++)this[o[d]]=function(t){return function(e,n){a(e),document.execCommand(t,!1,n)}}(o[d]);this.formatBlock=function(t,e){e=n?"<"+e+">":e,document.execCommand("FormatBlock",!1,e)},this.fontSize=function(t,e){a(t),document.execCommand("fontSize",!1,3);var n=t.find("font[size=3]");n.removeAttr("size").css("font-size",e+"px")},this.lineHeight=function(t,n){a(t),e.stylePara(r.create(),{lineHeight:n})},this.unlink=function(t){var e=r.create();if(e.isOnAnchor()){a(t);var n=i.ancestor(e.sc,i.isAnchor);e=r.create(n,0,n,1),e.select(),document.execCommand("unlink")}},this.setLinkDialog=function(e,o){var l=r.create();if(l.isOnAnchor()){var d=i.ancestor(l.sc,i.isAnchor);l=r.create(d,0,d,1)}o({range:l,text:l.toString(),url:l.isOnAnchor()?i.ancestor(l.sc,i.isAnchor).href:""},function(o){l.select(),a(e);var i=-1!==o.toLowerCase().indexOf("://"),d=i?o:"http://"+o;if(n&&l.isCollapsed()){l.insertNode(t('<A id="linkAnchor">'+o+"</A>")[0]);var s=t("#linkAnchor").removeAttr("id").attr("href",d);l=r.create(s[0],0,s[0],1),l.select()}else document.execCommand("createlink",!1,d)})},this.color=function(t,e){var n=JSON.parse(e),o=n.foreColor,i=n.backColor;a(t),o&&document.execCommand("foreColor",!1,o),i&&document.execCommand("backColor",!1,i)},this.insertTable=function(e,o){a(e);for(var i,l=o.split("x"),d=l[0],s=l[1],c=[],u=n?"&nbsp;":"<br/>",f=0;d>f;f++)c.push("<td>"+u+"</td>");i=c.join("");for(var h,v=[],b=0;s>b;b++)v.push("<tr>"+i+"</tr>");h=v.join("");var g='<table class="table table-bordered">'+h+"</table>";r.create().insertNode(t(g)[0])},this.float=function(t,e,n){a(t),n.style.cssFloat=e},this.resize=function(t,e,n){a(t),n.style.width=t.width()*e+"px",n.style.height=""},this.resizeTo=function(t,e){var n=t.y/t.x,a=e.data("ratio");e.css({width:a>n?t.x:t.y/a,height:a>n?t.x*a:t.y})}},c=function(){this.update=function(e,n){var a=function(e,n){e.find(".dropdown-menu li a").each(function(){var e=t(this).attr("data-value")==n;this.className=e?"checked":""})},o=e.find(".note-fontsize");o.find(".note-current-fontsize").html(n["font-size"]),a(o,parseFloat(n["font-size"]));var i=e.find(".note-height");a(i,parseFloat(n["line-height"]));var r=function(t,n){var a=e.find(t);a[n()?"addClass":"removeClass"]("active")};r('button[data-event="bold"]',function(){return"bold"===n["font-bold"]}),r('button[data-event="italic"]',function(){return"italic"===n["font-italic"]}),r('button[data-event="underline"]',function(){return"underline"===n["font-underline"]}),r('button[data-event="justifyLeft"]',function(){return"left"===n["text-align"]||"start"===n["text-align"]}),r('button[data-event="justifyCenter"]',function(){return"center"===n["text-align"]}),r('button[data-event="justifyRight"]',function(){return"right"===n["text-align"]}),r('button[data-event="justifyFull"]',function(){return"justify"===n["text-align"]}),r('button[data-event="insertUnorderedList"]',function(){return"unordered"===n["list-style"]}),r('button[data-event="insertOrderedList"]',function(){return"ordered"===n["list-style"]})},this.updateRecentColor=function(e,n,a){var o=t(e).closest(".note-color"),i=o.find(".note-recent-color"),r=JSON.parse(i.attr("data-value"));r[n]=a,i.attr("data-value",JSON.stringify(r));var l="backColor"===n?"background-color":"color";i.find("i").css(l,a)},this.updateFullscreen=function(t,e){var n=t.find('button[data-event="fullscreen"]');n[e?"addClass":"removeClass"]("active")},this.updateCodeview=function(t,e){var n=t.find('button[data-event="codeview"]');n[e?"addClass":"removeClass"]("active")},this.enable=function(t){t.find("button").not('button[data-event="codeview"]').removeClass("disabled")},this.disable=function(t){t.find("button").not('button[data-event="codeview"]').addClass("disabled")}},u=function(){var e=function(e,n){var a=t(n),o=a.position(),i=a.height();e.css({display:"block",left:o.left,top:o.top+i})};this.update=function(t,n){var a=t.find(".note-link-popover"),o=t.find(".note-image-popover");if(n.anchor){var i=a.find("a");i.attr("href",n.anchor.href).html(n.anchor.href),e(a,n.anchor)}else a.hide();n.image?e(o,n.image):o.hide()},this.hide=function(t){t.children().hide()}},f=function(){this.update=function(e,n){var a=e.find(".note-control-selection");if(n.image){var o=t(n.image),i=o.position(),r={w:o.width(),h:o.height()};a.css({display:"block",left:i.left,top:i.top,width:r.w,height:r.h}).data("target",n.image);var l=r.w+"x"+r.h;a.find(".note-control-selection-info").text(l)}else a.hide()},this.hide=function(t){t.children().hide()}},h=function(){this.showImageDialog=function(e,n,a){var o=e.find(".note-image-dialog"),i=e.find(".note-dropzone"),r=e.find(".note-image-input");o.on("shown.bs.modal",function(){i.on("dragenter dragover dragleave",!1),i.on("drop",function(t){n(t),o.modal("hide")}),r.on("change",function(){a(this.files),t(this).val(""),o.modal("hide")})}).on("hidden.bs.modal",function(){i.off("dragenter dragover dragleave drop"),r.off("change"),o.off("shown.bs.modal hidden.bs.modal")}).modal("show")},this.showLinkDialog=function(t,e,n){var a=t.find(".note-link-dialog"),o=a.find(".note-link-text"),i=a.find(".note-link-url"),r=a.find(".note-link-btn");a.on("shown.bs.modal",function(){o.html(e.text),i.val(e.url).keyup(function(){i.val()?r.removeClass("disabled").attr("disabled",!1):r.addClass("disabled").attr("disabled",!0),e.text||o.html(i.val())}).trigger("focus"),r.click(function(t){a.modal("hide"),n(i.val()),t.preventDefault()})}).on("hidden.bs.modal",function(){i.off("keyup"),r.off("click"),a.off("shown.bs.modal hidden.bs.modal")}).modal("show")},this.showHelpDialog=function(t){t.find(".note-help-dialog").modal("show")}},v=function(){var n=new s,a=new c,o=new u,r=new f,l=new h,d={BACKSPACE:8,TAB:9,ENTER:13,SPACE:32,NUM0:48,NUM1:49,NUM6:54,NUM7:55,NUM8:56,B:66,E:69,I:73,J:74,K:75,L:76,R:82,S:83,U:85,Y:89,Z:90,SLASH:191,LEFTBRACKET:219,BACKSLACH:220,RIGHTBRACKET:221},v=function(e){var n=t(e).closest(".note-editor");return{editor:function(){return n},toolbar:function(){return n.find(".note-toolbar")},editable:function(){return n.find(".note-editable")},codeable:function(){return n.find(".note-codeable")},statusbar:function(){return n.find(".note-statusbar")},popover:function(){return n.find(".note-popover")},handle:function(){return n.find(".note-handle")},dialog:function(){return n.find(".note-dialog")}}},b=function(t){var a=e?t.metaKey:t.ctrlKey,o=t.shiftKey,i=t.keyCode,r=a||o||i===d.TAB,s=r?v(t.target):null;if(i===d.TAB&&s.editable().data("tabsize"))n.tab(s.editable());else if(a&&(o&&i===d.Z||i===d.Y))n.redo(s.editable());else if(a&&i===d.Z)n.undo(s.editable());else if(a&&i===d.B)n.bold(s.editable());else if(a&&i===d.I)n.italic(s.editable());else if(a&&i===d.U)n.underline(s.editable());else if(a&&o&&i===d.S)n.strikethrough(s.editable());else if(a&&i===d.BACKSLACH)n.removeFormat(s.editable());else if(a&&i===d.K)n.setLinkDialog(s.editable(),function(t,e){l.showLinkDialog(s.dialog(),t,e)});else if(a&&i===d.SLASH)l.showHelpDialog(s.dialog());else if(a&&o&&i===d.L)n.justifyLeft(s.editable());else if(a&&o&&i===d.E)n.justifyCenter(s.editable());else if(a&&o&&i===d.R)n.justifyRight(s.editable());else if(a&&o&&i===d.J)n.justifyFull(s.editable());else if(a&&o&&i===d.NUM7)n.insertUnorderedList(s.editable());else if(a&&o&&i===d.NUM8)n.insertOrderedList(s.editable());else if(a&&i===d.LEFTBRACKET)n.outdent(s.editable());else if(a&&i===d.RIGHTBRACKET)n.indent(s.editable());else if(a&&i===d.NUM0)n.formatBlock(s.editable(),"P");else if(a&&d.NUM1<=i&&i<=d.NUM6){var c="H"+String.fromCharCode(i);n.formatBlock(s.editable(),c)}else{if(!a||i!==d.ENTER)return(i===d.BACKSPACE||i===d.ENTER||i===d.SPACE)&&n.recordUndo(v(t.target).editable()),void 0;n.insertHorizontalRule(s.editable())}t.preventDefault()},g=function(e,a){e.trigger("focus"),t.each(a,function(t,a){var o=new FileReader;o.onload=function(t){n.insertImage(e,t.target.result)},o.readAsDataURL(a)})},p=function(t){var e=t.originalEvent.dataTransfer;if(e&&e.files){var n=v(t.currentTarget||t.target);g(n.editable(),e.files)}t.stopPropagation(),t.preventDefault()},m=function(t){i.isImg(t.target)&&t.preventDefault()},y=function(t){var e=v(t.currentTarget||t.target),i=n.currentStyle(t.target);i&&(a.update(e.toolbar(),i),o.update(e.popover(),i),r.update(e.handle(),i))},C=function(t){var e=v(t.currentTarget||t.target);o.hide(e.popover()),r.hide(e.handle())},k=function(e){if(i.isControlSizing(e.target)){var a,l=v(e.target),d=l.handle(),s=l.popover(),c=l.editable(),u=l.editor(),f=d.find(".note-control-selection").data("target"),h=t(f),b=h.offset(),g=t(document).scrollTop();u.on("mousemove",function(t){a={x:t.clientX-b.left,y:t.clientY-(b.top-g)},n.resizeTo(a,h),r.update(d,{image:f}),o.update(s,{image:f})}).on("mouseup",function(){u.off("mousemove").off("mouseup")}),h.data("ratio")||h.data("ratio",h.height()/h.width()),n.recordUndo(c),e.stopPropagation(),e.preventDefault()}},x=function(e){var n=t(e.target).closest("[data-event]");n.length>0&&e.preventDefault()},w=function(e){var o=t(e.target).closest("[data-event]");if(o.length>0){var i,r=o.attr("data-event"),d=o.attr("data-value"),s=v(e.target),c=s.dialog(),u=s.editable(),f=s.codeable();if(-1!==t.inArray(r,["resize","float"])){var h=s.handle(),b=h.find(".note-control-selection");i=b.data("target")}if(n[r]&&(u.trigger("focus"),n[r](u,d,i)),-1!==t.inArray(r,["backColor","foreColor"]))a.updateRecentColor(o[0],r,d);else if("showLinkDialog"===r)n.setLinkDialog(u,function(t,e){l.showLinkDialog(c,t,e)});else if("showImageDialog"===r)l.showImageDialog(c,p,function(t){g(u,t)});else if("showHelpDialog"===r)l.showHelpDialog(c);else if("fullscreen"===r){var m=s.editor();m.toggleClass("fullscreen");var C=s.toolbar(),k=function(){var e=t(window).height()-C.outerHeight();u.css("height",e)},x=m.hasClass("fullscreen");x?(u.data("orgHeight",u.css("height")),t(window).resize(k).trigger("resize")):(u.css("height",u.data("orgHeight")),t(window).off("resize")),a.updateFullscreen(C,x)}else if("codeview"===r){var m=s.editor(),C=s.toolbar();m.toggleClass("codeview");var w=m.hasClass("codeview");w?(f.val(u.html()),f.height(u.height()),a.disable(C),f.focus()):(u.html(f.val()),u.height(f.height()),a.enable(C),u.focus()),a.updateCodeview(s.toolbar(),w)}y(e)}},F=24,A=function(e){var n=t(document),a=v(e.target),o=a.editable(),i=(a.codeable(),o.offset().top-n.scrollTop()),r=function(t){o.height(t.clientY-(i+F))},l=function(){n.unbind("mousemove",r).unbind("mouseup",l)};n.mousemove(r).mouseup(l),e.stopPropagation(),e.preventDefault()},S=18,T=function(e){var n,a=t(e.target.parentNode),o=a.next(),i=a.find(".note-dimension-picker-mousecatcher"),r=a.find(".note-dimension-picker-highlighted"),l=a.find(".note-dimension-picker-unhighlighted");if(void 0===e.offsetX){var d=t(e.target).offset();n={x:e.pageX-d.left,y:e.pageY-d.top}}else n={x:e.offsetX,y:e.offsetY};var s={c:Math.ceil(n.x/S)||1,r:Math.ceil(n.y/S)||1};r.css({width:s.c+"em",height:s.r+"em"}),i.attr("data-value",s.c+"x"+s.r),3<s.c&&s.c<10&&l.css({width:s.c+1+"em"}),3<s.r&&s.r<10&&l.css({height:s.r+1+"em"}),o.html(s.c+" x "+s.r)};this.attach=function(t,e){t.editable.on("keydown",b),t.editable.on("mousedown",m),t.editable.on("keyup mouseup",y),t.editable.on("scroll",C),t.editable.on("dragenter dragover dragleave",!1),t.editable.on("drop",p),t.handle.on("mousedown",k),t.toolbar.on("click",w),t.popover.on("click",w),t.toolbar.on("mousedown",x),t.popover.on("mousedown",x),t.statusbar.on("mousedown",A);var n=t.toolbar,a=n.find(".note-dimension-picker-mousecatcher");a.on("mousemove",T),e.onenter&&t.editable.keypress(function(t){t.keyCode===d.ENTER&&e.onenter(t)}),e.onfocus&&t.editable.focus(e.onfocus),e.onblur&&t.editable.blur(e.onblur),e.onkeyup&&t.editable.keyup(e.onkeyup),e.onkeydown&&t.editable.keydown(e.onkeydown)},this.dettach=function(t){t.editable.off(),t.toolbar.off(),t.handle.off(),t.popover.off()}},b=function(){{var n={picture:'<button type="button" class="btn btn-default" title="Picture" data-event="showImageDialog" tabindex="-1"><i class="fa fa-picture-o"></i></button>',link:'<button type="button" class="btn btn-default" title="Link" data-event="showLinkDialog" data-shortcut="Ctrl+K" data-mac-shortcut="⌘+K" tabindex="-1"><i class="fa fa-link"></i></button>',table:'<button type="button" class="btn btn-default dropdown-toggle" title="Table" data-toggle="dropdown" tabindex="-1"><i class="fa fa-table"></i> <span class="caret"></span></button><ul class="dropdown-menu"><div class="note-dimension-picker"><div class="note-dimension-picker-mousecatcher" data-event="insertTable" data-value="1x1"></div><div class="note-dimension-picker-highlighted"></div><div class="note-dimension-picker-unhighlighted"></div></div><div class="note-dimension-display"> 1 x 1 </div></ul>',style:'<button type="button" class="btn btn-default dropdown-toggle" title="Style" data-toggle="dropdown" tabindex="-1"><i class="fa fa-magic"></i> <span class="caret"></span></button><ul class="dropdown-menu"><li><a data-event="formatBlock" data-value="p">Normal</a></li><li><a data-event="formatBlock" data-value="blockquote"><blockquote>Quote</blockquote></a></li><li><a data-event="formatBlock" data-value="pre">Code</a></li><li><a data-event="formatBlock" data-value="h1"><h1>Header 1</h1></a></li><li><a data-event="formatBlock" data-value="h2"><h2>Header 2</h2></a></li><li><a data-event="formatBlock" data-value="h3"><h3>Header 3</h3></a></li><li><a data-event="formatBlock" data-value="h4"><h4>Header 4</h4></a></li><li><a data-event="formatBlock" data-value="h5"><h5>Header 5</h5></a></li><li><a data-event="formatBlock" data-value="h6"><h6>Header 6</h6></a></li></ul>',fontsize:'<button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" title="Font Size" tabindex="-1"><span class="note-current-fontsize">11</span> <b class="caret"></b></button><ul class="dropdown-menu"><li><a data-event="fontSize" data-value="8"><i class="fa fa-check"></i> 8</a></li><li><a data-event="fontSize" data-value="9"><i class="fa fa-check"></i> 9</a></li><li><a data-event="fontSize" data-value="10"><i class="fa fa-check"></i> 10</a></li><li><a data-event="fontSize" data-value="11"><i class="fa fa-check"></i> 11</a></li><li><a data-event="fontSize" data-value="12"><i class="fa fa-check"></i> 12</a></li><li><a data-event="fontSize" data-value="14"><i class="fa fa-check"></i> 14</a></li></ul>',color:'<button type="button" class="btn btn-default note-recent-color" title="Recent Color" data-event="color" data-value=\'{"backColor":"yellow"}\' tabindex="-1"><i class="fa fa-font" style="color:black;background-color:yellow;"></i></button><button type="button" class="btn btn-default dropdown-toggle" title="More Color" data-toggle="dropdown" tabindex="-1"><span class="caret"></span></button><ul class="dropdown-menu"><li><div class="btn-group"><div class="note-palette-title">BackColor</div><div class="note-color-reset" data-event="backColor" data-value="inherit" title="Transparent">Set transparent</div><div class="note-color-palette" data-target-event="backColor"></div></div><div class="btn-group"><div class="note-palette-title">FontColor</div><div class="note-color-reset" data-event="foreColor" data-value="inherit" title="Reset">Reset to default</div><div class="note-color-palette" data-target-event="foreColor"></div></div></li></ul>',bold:'<button type="button" class="btn btn-default" title="Bold" data-shortcut="Ctrl+B" data-mac-shortcut="⌘+B" data-event="bold" tabindex="-1"><i class="fa fa-bold"></i></button>',italic:'<button type="button" class="btn btn-default" title="Italic" data-shortcut="Ctrl+I" data-mac-shortcut="⌘+I" data-event="italic" tabindex="-1"><i class="fa fa-italic"></i></button>',underline:'<button type="button" class="btn btn-default" title="Underline" data-shortcut="Ctrl+U" data-mac-shortcut="⌘+U" data-event="underline" tabindex="-1"><i class="fa fa-underline"></i></button>',clear:'<button type="button" class="btn btn-default" title="Remove Font Style" data-shortcut="Ctrl+\\" data-mac-shortcut="⌘+\\" data-event="removeFormat" tabindex="-1"><i class="fa fa-eraser"></i></button>',ul:'<button type="button" class="btn btn-default" title="Unordered list" data-shortcut="Ctrl+Shift+8" data-mac-shortcut="⌘+⇧+7" data-event="insertUnorderedList" tabindex="-1"><i class="fa fa-list-ul"></i></button>',ol:'<button type="button" class="btn btn-default" title="Ordered list" data-shortcut="Ctrl+Shift+7" data-mac-shortcut="⌘+⇧+8" data-event="insertOrderedList" tabindex="-1"><i class="fa fa-list-ol"></i></button>',paragraph:'<button type="button" class="btn btn-default dropdown-toggle" title="Paragraph" data-toggle="dropdown" tabindex="-1"><i class="fa fa-align-left"></i>  <span class="caret"></span></button><ul class="dropdown-menu"><li><div class="note-align btn-group"><button type="button" class="btn btn-default" title="Align left" data-shortcut="Ctrl+Shift+L" data-mac-shortcut="⌘+⇧+L" data-event="justifyLeft" tabindex="-1"><i class="fa fa-align-left"></i></button><button type="button" class="btn btn-default" title="Align center" data-shortcut="Ctrl+Shift+E" data-mac-shortcut="⌘+⇧+E" data-event="justifyCenter" tabindex="-1"><i class="fa fa-align-center"></i></button><button type="button" class="btn btn-default" title="Align right" data-shortcut="Ctrl+Shift+R" data-mac-shortcut="⌘+⇧+R" data-event="justifyRight" tabindex="-1"><i class="fa fa-align-right"></i></button><button type="button" class="btn btn-default" title="Justify full" data-shortcut="Ctrl+Shift+J" data-mac-shortcut="⌘+⇧+J" data-event="justifyFull" tabindex="-1"><i class="fa fa-align-justify"></i></button></div></li><li><div class="note-list btn-group"><button type="button" class="btn btn-default" title="Outdent" data-shortcut="Ctrl+[" data-mac-shortcut="⌘+[" data-event="outdent" tabindex="-1"><i class="fa fa-indent-left"></i></button><button type="button" class="btn btn-default" title="Indent" data-shortcut="Ctrl+]" data-mac-shortcut="⌘+]" data-event="indent" tabindex="-1"><i class="fa fa-indent-right"></i></button></li></ul>',height:'<button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" title="Line Height" tabindex="-1"><i class="fa fa-text-height"></i>&nbsp; <b class="caret"></b></button><ul class="dropdown-menu"><li><a data-event="lineHeight" data-value="1.0"><i class="fa fa-check"></i> 1.0</a></li><li><a data-event="lineHeight" data-value="1.2"><i class="fa fa-check"></i> 1.2</a></li><li><a data-event="lineHeight" data-value="1.4"><i class="fa fa-check"></i> 1.4</a></li><li><a data-event="lineHeight" data-value="1.5"><i class="fa fa-check"></i> 1.5</a></li><li><a data-event="lineHeight" data-value="1.6"><i class="fa fa-check"></i> 1.6</a></li><li><a data-event="lineHeight" data-value="1.8"><i class="fa fa-check"></i> 1.8</a></li><li><a data-event="lineHeight" data-value="2.0"><i class="fa fa-check"></i> 2.0</a></li><li><a data-event="lineHeight" data-value="3.0"><i class="fa fa-check"></i> 3.0</a></li></ul>',help:'<button type="button" class="btn btn-default" title="Help" data-shortcut="Ctrl+/" data-mac-shortcut="⌘+/" data-event="showHelpDialog" tabindex="-1"><i class="fa fa-question"></i></button>',fullscreen:'<button type="button" class="btn btn-default" title="Full Screen" data-event="fullscreen" tabindex="-1"><i class="fa fa-fullscreen"></i></button>',codeview:'<button type="button" class="btn btn-default" title="Code View" data-event="codeview" tabindex="-1"><i class="fa fa-code"></i></button>'},a='<div class="note-popover"><div class="note-link-popover popover bottom in" style="display: none;"><div class="arrow"></div><div class="popover-content note-link-content"><a href="http://www.google.com" target="_blank">www.google.com</a>&nbsp;&nbsp;<div class="note-insert btn-group"><button type="button" class="btn btn-default" title="Edit" data-event="showLinkDialog" tabindex="-1"><i class="fa fa-edit"></i></button><button type="button" class="btn btn-default" title="Unlink" data-event="unlink" tabindex="-1"><i class="fa fa-unlink"></i></button></div></div></div><div class="note-image-popover popover bottom in" style="display: none;"><div class="arrow"></div><div class="popover-content note-image-content"><div class="btn-group"><button type="button" class="btn btn-default" title="Resize Full" data-event="resize" data-value="1" tabindex="-1"><i class="fa fa-resize-full"></i></button><button type="button" class="btn btn-default" title="Resize Half" data-event="resize" data-value="0.5" tabindex="-1">½</button><button type="button" class="btn btn-default" title="Resize Thrid" data-event="resize" data-value="0.33" tabindex="-1">⅓</button><button type="button" class="btn btn-default" title="Resize Quarter" data-event="resize" data-value="0.25" tabindex="-1">¼</button></div><div class="btn-group"><button type="button" class="btn btn-default" title="Float Left" data-event="float" data-value="left" tabindex="-1"><i class="fa fa-align-left"></i></button><button type="button" class="btn btn-default" title="Float Right" data-event="float" data-value="right" tabindex="-1"><i class="fa fa-align-right"></i></button><button type="button" class="btn btn-default" title="Float None" data-event="float" data-value="none" tabindex="-1"><i class="fa fa-reorder"></i></button></div></div></div></div>',o='<div class="note-handle"><div class="note-control-selection"><div class="note-control-selection-bg"></div><div class="note-control-holder note-control-nw"></div><div class="note-control-holder note-control-ne"></div><div class="note-control-holder note-control-sw"></div><div class="note-control-sizing note-control-se"></div><div class="note-control-selection-info"></div></div></div>',r='<table class="note-shortcut"><thead><tr><th></th><th>Text formatting</th></tr></thead><tbody><tr><td>⌘ + B</td><td>Toggle Bold</td></tr><tr><td>⌘ + I</td><td>Toggle Italic</td></tr><tr><td>⌘ + U</td><td>Toggle Underline</td></tr><tr><td>⌘ + ⇧ + S</td><td>Toggle Strike</td></tr><tr><td>⌘ + \\</td><td>Remove Font Style</td></tr></tr></tbody></table>',l='<table class="note-shortcut"><thead><tr><th></th><th>Action</th></tr></thead><tbody><tr><td>⌘ + Z</td><td>Undo</td></tr><tr><td>⌘ + ⇧ + Z</td><td>Redo</td></tr><tr><td>⌘ + ]</td><td>Indent</td></tr><tr><td>⌘ + [</td><td>Outdent</td></tr><tr><td>⌘ + K</td><td>Insert Link</td></tr><tr><td>⌘ + ENTER</td><td>Insert Horizontal Rule</td></tr></tbody></table>',s='<table class="note-shortcut"><thead><tr><th></th><th>Paragraph formatting</th></tr></thead><tbody><tr><td>⌘ + ⇧ + L</td><td>Align Left</td></tr><tr><td>⌘ + ⇧ + E</td><td>Align Center</td></tr><tr><td>⌘ + ⇧ + R</td><td>Align Right</td></tr><tr><td>⌘ + ⇧ + J</td><td>Justify Full</td></tr><tr><td>⌘ + ⇧ + NUM7</td><td>Ordered List</td></tr><tr><td>⌘ + ⇧ + NUM8</td><td>Unordered List</td></tr></tbody></table>',c='<table class="note-shortcut"><thead><tr><th></th><th>Document Style</th></tr></thead><tbody><tr><td>⌘ + NUM0</td><td>Normal Text</td></tr><tr><td>⌘ + NUM1</td><td>Heading 1</td></tr><tr><td>⌘ + NUM2</td><td>Heading 2</td></tr><tr><td>⌘ + NUM3</td><td>Heading 3</td></tr><tr><td>⌘ + NUM4</td><td>Heading 4</td></tr><tr><td>⌘ + NUM5</td><td>Heading 5</td></tr><tr><td>⌘ + NUM6</td><td>Heading 6</td></tr></tbody></table>',u='<table class="note-shortcut-layout"><tbody><tr><td>'+l+"</td><td>"+r+"</td></tr><tr><td>"+c+"</td><td>"+s+"</td></tr></tbody></table>",f='<div class="note-dialog"><div class="note-image-dialog modal" aria-hidden="false"><div class="modal-dialog"><div class="modal-content"><div class="modal-header"><button type="button" class="close" aria-hidden="true" tabindex="-1">×</button><h4>Insert Image</h4></div><div class="modal-body"><div class="row-fluid"><div class="note-dropzone span12">Drag an image here</div><div>or if you prefer...</div><input class="note-image-input" type="file" class="note-link-url" type="text" /></div></div></div></div></div><div class="note-link-dialog modal" aria-hidden="false"><div class="modal-dialog"><div class="modal-content"><div class="modal-header"><button type="button" class="close" aria-hidden="true" tabindex="-1">×</button><h4>Edit Link</h4></div><div class="modal-body"><div class="row-fluid"><div class="form-group"><label>Text to display</label><span class="note-link-text form-control input-xlarge uneditable-input" /></div><div class="form-group"><label>To what URL should this link go?</label><input class="note-link-url form-control span12" type="text" /></div></div></div><div class="modal-footer"><button href="#" class="btn btn-primary note-link-btn disabled" disabled="disabled">Link</button></div></div></div></div><div class="note-help-dialog modal" aria-hidden="false"><div class="modal-dialog"><div class="modal-content"><div class="modal-body"><div class="modal-background"><a class="modal-close pull-right" aria-hidden="true" tabindex="-1">Close</a><div class="title">Smart shortcuts</div>'+u+"</div></div></div></div></div>",h=function(n,a){n.find("button").each(function(n,a){var o=t(a),i=o.attr(e?"data-mac-shortcut":"data-shortcut");
i&&o.attr("title",function(t,e){return e+" ("+i+")"})}).tooltip({container:"body",placement:a||"top"})},v=[["#000000","#424242","#636363","#9C9C94","#CEC6CE","#EFEFEF","#EFF7F7","#FFFFFF"],["#FF0000","#FF9C00","#FFFF00","#00FF00","#00FFFF","#0000FF","#9C00FF","#FF00FF"],["#F7C6CE","#FFE7CE","#FFEFC6","#D6EFD6","#CEDEE7","#CEE7F7","#D6D6E7","#E7D6DE"],["#E79C9C","#FFC69C","#FFE79C","#B5D6A5","#A5C6CE","#9CC6EF","#B5A5D6","#D6A5BD"],["#E76363","#F7AD6B","#FFD663","#94BD7B","#73A5AD","#6BADDE","#8C7BC6","#C67BA5"],["#CE0000","#E79439","#EFC631","#6BA54A","#4A7B8C","#3984C6","#634AA5","#A54A7B"],["#9C0000","#B56308","#BD9400","#397B21","#104A5A","#085294","#311873","#731842"],["#630000","#7B3900","#846300","#295218","#083139","#003163","#21104A","#4A1031"]],b=function(e){e.find(".note-color-palette").each(function(){for(var e=t(this),n=e.attr("data-target-event"),a="",o=0,i=v.length;i>o;o++){for(var r=v[o],l="<div>",d=0,s=r.length;s>d;d++){var c=r[d],u=['<button type="button" class="note-color-btn" style="background-color:',c,';" data-event="',n,'" data-value="',c,'" title="',c,'" data-toggle="button" tabindex="-1"></button>'].join("");l+=u}l+="</div>",a+=l}e.html(a)})},g=(this.createLayout=function(e,r,l,s){if(!e.next().hasClass("note-editor")){var c=t('<div class="note-editor"></div>');if(r>0){t('<div class="note-statusbar"><div class="note-resizebar"><div class="note-icon-bar"></div><div class="note-icon-bar"></div><div class="note-icon-bar"></div></div></div>').prependTo(c)}var u=t('<div class="note-editable custom-scroll" contentEditable="true"></div>').prependTo(c);r&&u.height(r),l&&u.data("tabsize",l),u.html(i.html(e)),u.data("NoteHistory",new d);{t('<textarea class="note-codeable"></textarea>').prependTo(c)}setTimeout(function(){try{document.execCommand("styleWithCSS",0,!1)}catch(t){try{document.execCommand("useCSS",0,!0)}catch(t){try{document.execCommand("styleWithCSS",!1,!1)}catch(t){}}}});for(var v="",g=0,p=s.length;p>g;g++){var m=s[g];v+='<div class="note-'+m[0]+' btn-group">';for(var y=0,C=m[1].length;C>y;y++)v+=n[m[1][y]];v+="</div>"}v='<div class="note-toolbar btn-toolbar">'+v+"</div>";var k=t(v).prependTo(c);b(k),h(k,"bottom");var x=t(a).prependTo(c);h(x),t(o).prependTo(c);var w=t(f).prependTo(c);w.find("button.close, a.modal-close").click(function(){t(this).closest(".modal").modal("hide")}),c.insertAfter(e),e.hide()}},this.layoutInfoFromHolder=function(t){var e=t.next();if(e.hasClass("note-editor"))return{editor:e,toolbar:e.find(".note-toolbar"),editable:e.find(".note-editable"),statusbar:e.find(".note-statusbar"),popover:e.find(".note-popover"),handle:e.find(".note-handle"),dialog:e.find(".note-dialog")}});this.removeLayout=function(t){var e=g(t);e&&(t.html(e.editable.html()),e.editor.remove(),t.show())}}},g=new b,p=new v;t.fn.extend({summernote:function(e){if(e=t.extend({toolbar:[["style",["style"]],["font",["bold","italic","underline","clear"]],["fontsize",["fontsize"]],["color",["color"]],["para",["ul","ol","paragraph"]],["height",["height"]],["table",["table"]],["insert",["link","picture"]],["view",["fullscreen","codeview"]],["help",["help"]]]},e),this.each(function(n,a){var o=t(a);g.createLayout(o,e.height,e.tabsize,e.toolbar);var i=g.layoutInfoFromHolder(o);p.attach(i,e)}),this.first()&&e.focus){var n=g.layoutInfoFromHolder(this.first());n.editable.focus()}this.length>0&&e.oninit&&e.oninit()},code:function(e){if(void 0===e){var n=this.first();if(0==n.length)return;var a=g.layoutInfoFromHolder(n),o=!(!a||!a.editable);return o?a.editable.html():n.html()}this.each(function(n,a){var o=g.layoutInfoFromHolder(t(a));o&&o.editable&&o.editable.html(e)})},destroy:function(){this.each(function(e,n){var a=t(n),o=g.layoutInfoFromHolder(a);o&&o.editable&&(p.dettach(o),g.removeLayout(a))})},summernoteInner:function(){return{dom:i,list:o,func:a,range:r}}})}(window.jQuery),"function"!=typeof Array.prototype.reduce&&(Array.prototype.reduce=function(t,e){"use strict";var n,a,o=this.length>>>0,i=!1;for(1<arguments.length&&(a=e,i=!0),n=0;o>n;++n)this.hasOwnProperty(n)&&(i?a=t(a,this[n],n,this):(a=this[n],i=!0));if(!i)throw new TypeError("Reduce of empty array with no initial value");return a});